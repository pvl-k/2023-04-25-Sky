# Тестовое задание на позицию Data Engineer. Выполнил Павел Коротков, tlg: @pvl_ko

## В качестве альтернативных предложений по решению поставленной задачи:
### 1
ClickHouse имеет [встроенный инструмент](https://clickhouse.com/blog/migrating-data-between-clickhouse-postgres) репликации таблиц PostgreSQL.
В таком случае vмы также используем VIEW, созданный силами PostgreSQL на этапе 1-2, и реплицируем VIEW в ClickHouse его собственным кликхаусовским инструментом.
На мой взгляд это достаточное интересно решение, но не гибкое. 
Если, допустим, ClickHouse будет заменён на BigQuery, или Greenplum, либо другую платформу без встроенного механизма репликации БД PostgreSQL, то поставленную задачу придется решать с нуля.
### 2
Также ClickHouse содержит [инструмент](https://clickhouse.com/docs/knowledgebase/postgresql-to-parquet-csv-json) подключения к PostgreSQL и сохранения сделанного SELECT'a в Parquet, JSON, CSV.
Можно воспользоваться этим вариантом для сохранения истории, например, в Parquet формат. 
Далее эти Parquet-файлы уже загружать с аналитическую базу.
